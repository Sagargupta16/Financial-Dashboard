{
  "inventory": {
    "calculateDateRange": [
      {
        "file": "src/shared/utils/financialCalculations.js",
        "line": "14-36",
        "signature": "(transactions) => {days, months, years, startDate, endDate}",
        "variant": "canonical"
      },
      {
        "file": "src/shared/utils/calculations.js",
        "line": "9-28",
        "signature": "(data) => {startDate, endDate, totalDays}",
        "variant": "deprecated - returns different property names (totalDays vs days)"
      }
    ],
    "calculateTotalIncome": [
      {
        "file": "src/shared/utils/financialCalculations.js",
        "line": "41-51",
        "signature": "(transactions) => number",
        "variant": "canonical"
      }
    ],
    "calculateTotalExpense": [
      {
        "file": "src/shared/utils/financialCalculations.js",
        "line": "53-63",
        "signature": "(transactions) => number",
        "variant": "canonical"
      }
    ],
    "calculateSavings": [
      {
        "file": "src/shared/utils/financialCalculations.js",
        "line": "65-69",
        "signature": "(income, expense) => number",
        "variant": "canonical"
      }
    ],
    "calculateSavingsRate": [
      {
        "file": "src/shared/utils/financialCalculations.js",
        "line": "72-78",
        "signature": "(income, expense) => number (percentage)",
        "variant": "canonical"
      },
      {
        "file": "src/shared/utils/calculations.js",
        "line": "975-980",
        "signature": "(savings, income) => number",
        "variant": "deprecated - different parameter order"
      }
    ],
    "calculateDailyAverage": [
      {
        "file": "src/shared/utils/financialCalculations.js",
        "line": "82-88",
        "signature": "(total, days) => number",
        "variant": "canonical"
      },
      {
        "file": "src/shared/utils/calculations.js",
        "line": "30-32",
        "signature": "(total, totalDays) => number",
        "variant": "deprecated - duplicate"
      }
    ],
    "calculateMonthlyAverage": [
      {
        "file": "src/shared/utils/financialCalculations.js",
        "line": "92-98",
        "signature": "(total, days) => number",
        "variant": "canonical - uses (total/days) * 30.44"
      },
      {
        "file": "src/shared/utils/calculations.js",
        "line": "34-36",
        "signature": "(total, totalMonths) => number",
        "variant": "deprecated - direct division, different parameter semantics"
      }
    ],
    "calculateAveragePerTransaction": [
      {
        "file": "src/shared/utils/financialCalculations.js",
        "line": "102-108",
        "signature": "(total, count) => number",
        "variant": "canonical"
      },
      {
        "file": "src/shared/utils/calculations.js",
        "line": "38-40",
        "signature": "(total, count) => number",
        "variant": "deprecated - duplicate"
      }
    ],
    "calculatePercentage": [
      {
        "file": "src/shared/utils/financialCalculations.js",
        "line": "112-118",
        "signature": "(part, total) => number (0-100+)",
        "variant": "canonical"
      },
      {
        "file": "src/shared/utils/calculations.js",
        "line": "42-44",
        "signature": "(value, total) => number",
        "variant": "deprecated - duplicate"
      }
    ],
    "groupByCategory": [
      {
        "file": "src/shared/utils/financialCalculations.js",
        "line": "124-144",
        "signature": "(transactions) => {[category]: {total, count, transactions}}",
        "variant": "canonical"
      },
      {
        "file": "src/shared/utils/calculations.js",
        "line": "113-125",
        "signature": "(transactions) => {[category]: [...transactions]}",
        "variant": "deprecated - different return structure"
      },
      {
        "file": "src/features/budget/utils/budgetUtils.js",
        "line": "62-73",
        "name": "calculateCategorySpending",
        "signature": "(transactions) => {[category]: number}",
        "variant": "deprecated - returns only totals"
      }
    ],
    "getTopCategories": [
      {
        "file": "src/shared/utils/financialCalculations.js",
        "line": "146-160",
        "signature": "(transactions, limit=10) => [{category, total, count}]",
        "variant": "canonical"
      }
    ],
    "detectRecurringTransactions": [
      {
        "file": "src/shared/utils/calculations.js",
        "line": "463-560",
        "signature": "(transactions) => [{description, frequency, amount, ...}]",
        "variant": "canonical - sophisticated algorithm"
      },
      {
        "file": "src/features/budget/utils/budgetUtils.js",
        "line": "277-361",
        "name": "detectRecurringPayments",
        "signature": "(transactions) => [{category, amount, frequency, ...}]",
        "variant": "deprecated - simpler algorithm"
      }
    ],
    "magicNumbers": {
      "30.44": {
        "description": "Average days per month (365.25/12)",
        "occurrences": [
          "src/shared/utils/financialCalculations.js:32",
          "src/shared/utils/financialCalculations.js:96",
          "src/shared/utils/calculations.js:63",
          "src/shared/hooks/useAdvancedAnalytics.js:117",
          "src/features/budget/utils/budgetUtils.js:236"
        ],
        "constant": "DAYS_PER_MONTH"
      },
      "100": {
        "description": "Percentage multiplier",
        "occurrences": [
          "src/shared/utils/financialCalculations.js:76",
          "src/shared/utils/financialCalculations.js:116",
          "src/shared/utils/calculations.js:43"
        ],
        "constant": "PERCENT"
      },
      "75000": {
        "description": "Standard deduction NEW tax regime",
        "occurrences": ["src/shared/utils/financialCalculations.js:479"],
        "constant": "STANDARD_DEDUCTION_NEW_REGIME"
      },
      "150000": {
        "description": "Section 80C limit",
        "occurrences": ["src/shared/utils/financialCalculations.js:446"],
        "constant": "SECTION_80C_LIMIT"
      },
      "2400": {
        "description": "Default professional tax (annual)",
        "occurrences": ["src/shared/utils/financialCalculations.js:474"],
        "constant": "DEFAULT_PROFESSIONAL_TAX"
      },
      "0.04": {
        "description": "Health and Education Cess rate (4%)",
        "occurrences": ["src/shared/utils/financialCalculations.js:527"],
        "constant": "CESS_RATE"
      }
    }
  },
  "canonical_api": {
    "dateRange": {
      "function": "calculateDateRange",
      "signature": "(transactions: Array<{date: Date|string, ...}>) => {days: number, months: number, years: number, startDate: Date|null, endDate: Date|null}",
      "module": "calculations/dateRange.js",
      "rationale": "Single source of truth for date range calculations with consistent property names. Returns days (minimum 1 if data exists), months (days/30.44), years (months/12), and date boundaries.",
      "edge_cases": [
        "Empty array: returns {days: 0, months: 0, years: 0, startDate: null, endDate: null}",
        "Same-day transactions: returns days=1",
        "Invalid dates: filtered out, returns 0 if none valid"
      ]
    },
    "averages": {
      "functions": [
        {
          "function": "calculateDailyAverage",
          "signature": "(total: number, days: number) => number",
          "module": "calculations/averages.js",
          "rationale": "Simple division with zero-protection. Returns 0 if days=0.",
          "formula": "total / days"
        },
        {
          "function": "calculateMonthlyAverage",
          "signature": "(total: number, days: number) => number",
          "module": "calculations/averages.js",
          "rationale": "Converts daily average to monthly using DAYS_PER_MONTH constant (30.44). Returns 0 if days=0.",
          "formula": "(total / days) * 30.44"
        },
        {
          "function": "calculateAveragePerTransaction",
          "signature": "(total: number, count: number) => number",
          "module": "calculations/averages.js",
          "rationale": "Simple division with zero-protection. Returns 0 if count=0.",
          "formula": "total / count"
        }
      ]
    },
    "aggregations": {
      "functions": [
        {
          "function": "calculateTotalIncome",
          "signature": "(transactions: Array<{type: string, amount: number}>) => number",
          "module": "calculations/aggregations.js",
          "rationale": "Filters for type='Income', sums absolute values. Handles invalid amounts as 0.",
          "behavior": "Always returns positive number (uses Math.abs)"
        },
        {
          "function": "calculateTotalExpense",
          "signature": "(transactions: Array<{type: string, amount: number}>) => number",
          "module": "calculations/aggregations.js",
          "rationale": "Filters for type='Expense', sums absolute values. Handles invalid amounts as 0.",
          "behavior": "Always returns positive number (uses Math.abs)"
        }
      ]
    },
    "savings": {
      "functions": [
        {
          "function": "calculateSavings",
          "signature": "(income: number, expense: number) => number",
          "module": "calculations/savings.js",
          "rationale": "Simple subtraction. Can return negative (deficit).",
          "formula": "income - expense"
        },
        {
          "function": "calculateSavingsRate",
          "signature": "(income: number, expense: number) => number",
          "module": "calculations/savings.js",
          "rationale": "Returns percentage (0-100+). Returns 0 if income=0. Can be negative if expense > income.",
          "formula": "((income - expense) / income) * 100"
        },
        {
          "function": "calculatePercentage",
          "signature": "(part: number, total: number) => number",
          "module": "calculations/savings.js",
          "rationale": "Generic percentage calculation. Returns 0 if total=0.",
          "formula": "(part / total) * 100"
        }
      ]
    },
    "category": {
      "functions": [
        {
          "function": "groupByCategory",
          "signature": "(transactions: Array<{category?: string, amount: number}>) => {[category: string]: {total: number, count: number, transactions: Array}}",
          "module": "calculations/category.js",
          "rationale": "Groups all transactions by category. Missing category defaults to 'Uncategorized'. Returns structured object with totals, counts, and transaction arrays.",
          "behavior": "Accumulates absolute amounts, counts occurrences, preserves transaction references"
        },
        {
          "function": "getTopCategories",
          "signature": "(transactions: Array, limit?: number = 10) => Array<{category: string, total: number, count: number}>",
          "module": "calculations/category.js",
          "rationale": "Filters expenses only, groups by category, sorts by total descending, returns top N. Useful for spending analysis.",
          "behavior": "Returns empty array if no expense transactions. Limit defaults to 10."
        }
      ]
    }
  },
  "constants_mapping": {
    "DAYS_PER_MONTH": {
      "value": 30.44,
      "description": "Average days in a month (365.25 / 12)",
      "usage": "Monthly projections and averages"
    },
    "DAYS_PER_WEEK": {
      "value": 7,
      "description": "Days in a week"
    },
    "MONTHS_PER_YEAR": {
      "value": 12,
      "description": "Months in a year"
    },
    "MILLISECONDS_PER_DAY": {
      "value": 86400000,
      "description": "Milliseconds in one day (1000 * 60 * 60 * 24)"
    },
    "PERCENT": {
      "value": 100,
      "description": "Percentage multiplier",
      "usage": "Converting decimals to percentages"
    },
    "TAX_SLABS_NEW_REGIME": {
      "type": "Array<{min, max, rate}>",
      "description": "India NEW tax regime slabs (FY 2024-25 onwards)",
      "brackets": 7
    },
    "CESS_RATE": {
      "value": 0.04,
      "description": "Health and Education Cess (4% of tax)"
    },
    "STANDARD_DEDUCTION_NEW_REGIME": {
      "value": 75000,
      "description": "Standard deduction for salaried employees (New Regime)"
    },
    "SECTION_80C_LIMIT": {
      "value": 150000,
      "description": "Maximum 80C deduction limit"
    },
    "DEFAULT_PROFESSIONAL_TAX": {
      "value": 2400,
      "description": "Default professional tax (annual)"
    },
    "HRA_METRO_PERCENT": {
      "value": 0.5,
      "description": "HRA exemption for metro cities (50% of salary)"
    },
    "INVESTMENT_CATEGORIES": {
      "type": "Set<string>",
      "description": "Categories considered as investment-related"
    },
    "INVESTMENT_ACCOUNTS": {
      "type": "Set<string>",
      "description": "Accounts considered as investment accounts"
    }
  }
}
